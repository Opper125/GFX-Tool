<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MMR GAMING SHOP - Admin Dashboard</title>
    
    <!-- External Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Myanmar:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        * {
            font-family: 'Noto Sans Myanmar', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #1e3a8a 0%, #3730a3 25%, #581c87 50%, #7c2d12 75%, #dc2626 100%);
            min-height: 100vh;
            animation: gradientShift 10s ease infinite;
        }
        
        @keyframes gradientShift {
            0%, 100% { background: linear-gradient(135deg, #1e3a8a 0%, #3730a3 25%, #581c87 50%, #7c2d12 75%, #dc2626 100%); }
            50% { background: linear-gradient(135deg, #dc2626 0%, #7c2d12 25%, #581c87 50%, #3730a3 75%, #1e3a8a 100%); }
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 25px 45px rgba(0, 0, 0, 0.1);
        }
        
        .neo-card {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.85));
            backdrop-filter: blur(20px);
            border-radius: 25px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
        }
        
        .animate-fade-in {
            animation: fadeIn 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: translateY(30px) scale(0.95);
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1);
            }
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6, #ef4444);
            background-size: 200% 200%;
            animation: gradientMove 3s ease infinite;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: none;
            color: white;
            font-weight: 600;
        }
        
        @keyframes gradientMove {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .btn-primary:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 15px 35px rgba(59, 130, 246, 0.4);
        }
        
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .sidebar {
            background: linear-gradient(180deg, rgba(0, 0, 0, 0.95), rgba(0, 0, 0, 0.85));
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .sidebar-item {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 15px;
            margin: 8px 0;
            position: relative;
            overflow: hidden;
        }
        
        .sidebar-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }
        
        .sidebar-item:hover::before {
            left: 100%;
        }
        
        .sidebar-item:hover {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(139, 92, 246, 0.2));
            transform: translateX(8px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
        }
        
        .sidebar-item.active {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }
        
        .table-container {
            max-height: 600px;
            overflow-y: auto;
            border-radius: 15px;
        }
        
        .table-container::-webkit-scrollbar {
            width: 8px;
        }
        
        .table-container::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 10px;
        }
        
        .table-container::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            border-radius: 10px;
        }
        
        .modal {
            backdrop-filter: blur(10px);
            background: rgba(0, 0, 0, 0.7);
        }
        
        .modal-content {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.9));
            backdrop-filter: blur(20px);
            border-radius: 25px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
        }
        
        .status-pending { 
            color: #f59e0b; 
            background: rgba(245, 158, 11, 0.1);
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
        }
        .status-approved { 
            color: #10b981; 
            background: rgba(16, 185, 129, 0.1);
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
        }
        .status-rejected { 
            color: #ef4444; 
            background: rgba(239, 68, 68, 0.1);
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            animation: slideIn 0.3s ease-out;
            border-radius: 15px;
            padding: 15px 25px;
            color: white;
            font-weight: 600;
            max-width: 400px;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .success-notification {
            background: linear-gradient(135deg, #10b981, #059669);
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
        }
        
        .error-notification {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            box-shadow: 0 10px 25px rgba(239, 68, 68, 0.3);
        }
        
        .warning-notification {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            box-shadow: 0 10px 25px rgba(245, 158, 11, 0.3);
        }
        
        .stat-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.85));
            backdrop-filter: blur(20px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .stat-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .form-input {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
            outline: none;
        }
        
        .upload-area {
            border: 3px dashed rgba(59, 130, 246, 0.3);
            border-radius: 20px;
            background: linear-gradient(145deg, rgba(59, 130, 246, 0.05), rgba(139, 92, 246, 0.05));
            transition: all 0.3s ease;
        }
        
        .upload-area:hover {
            border-color: #3b82f6;
            background: linear-gradient(145deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1));
        }
        
        .hidden { display: none !important; }
    </style>
</head>
<body>
    <!-- Admin Login Page -->
    <div id="loginPage" class="min-h-screen flex items-center justify-center px-4">
        <div class="neo-card max-w-md w-full p-8 animate-fade-in">
            <div class="text-center mb-8">
                <div class="mb-6">
                    <i class="fas fa-shield-alt text-6xl bg-gradient-to-r from-blue-500 to-purple-600 bg-clip-text text-transparent"></i>
                </div>
                <h1 class="text-3xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent">MMR GAMING SHOP</h1>
                <p class="text-gray-600 mt-2 font-medium">Admin Dashboard</p>
            </div>
            
            <form id="adminLoginForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        <i class="fas fa-envelope mr-2 text-blue-500"></i>
                        အီးမေးလ်လိပ်စာ
                    </label>
                    <input type="email" id="adminEmail" required 
                           class="form-input w-full px-4 py-3" placeholder="admin@example.com">
                </div>
                
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        <i class="fas fa-lock mr-2 text-blue-500"></i>
                        စကားဝှက်
                    </label>
                    <input type="password" id="adminPassword" required 
                           class="form-input w-full px-4 py-3" placeholder="••••••••">
                </div>
                
                <button type="submit" class="w-full btn-primary py-3 rounded-xl font-semibold">
                    <span id="loginBtnText">ဝင်ရောက်မည်</span>
                    <div id="loginLoading" class="loading-spinner hidden ml-2"></div>
                </button>
            </form>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="hidden">
        <!-- Header -->
        <header class="glass-effect border-b border-white/20">
            <div class="flex items-center justify-between px-6 py-4">
                <div class="flex items-center space-x-4">
                    <i class="fas fa-gamepad text-3xl text-white"></i>
                    <h1 class="text-2xl font-bold text-white">MMR GAMING SHOP - Admin</h1>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-2">
                        <div class="w-3 h-3 bg-green-400 rounded-full animate-pulse"></div>
                        <span class="text-sm text-white/80">အွန်လိုင်း</span>
                    </div>
                    <button id="logoutBtn" class="flex items-center space-x-2 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-all duration-300">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>ထွက်မည်</span>
                    </button>
                </div>
            </div>
        </header>

        <div class="flex">
            <!-- Sidebar -->
            <aside class="sidebar w-64 min-h-screen p-4">
                <nav class="space-y-2">
                    <a href="#" class="sidebar-item active flex items-center space-x-3 px-4 py-3 text-white" data-page="dashboard">
                        <i class="fas fa-tachometer-alt w-5"></i>
                        <span>ဒက်ရှ်ဘုတ်</span>
                    </a>
                    <a href="#" class="sidebar-item flex items-center space-x-3 px-4 py-3 text-white" data-page="users">
                        <i class="fas fa-users w-5"></i>
                        <span>အသုံးပြုသူများ</span>
                    </a>
                    <a href="#" class="sidebar-item flex items-center space-x-3 px-4 py-3 text-white" data-page="products">
                        <i class="fas fa-box w-5"></i>
                        <span>ကုန်ပစ္စည်းများ</span>
                    </a>
                    <a href="#" class="sidebar-item flex items-center space-x-3 px-4 py-3 text-white" data-page="orders">
                        <i class="fas fa-shopping-cart w-5"></i>
                        <span>အမှာစာများ</span>
                    </a>
                    <a href="#" class="sidebar-item flex items-center space-x-3 px-4 py-3 text-white" data-page="payments">
                        <i class="fas fa-credit-card w-5"></i>
                        <span>ငွေပေးချေမှုများ</span>
                    </a>
                    <a href="#" class="sidebar-item flex items-center space-x-3 px-4 py-3 text-white" data-page="kyc">
                        <i class="fas fa-id-card w-5"></i>
                        <span>KYC အတည်ပြုမှု</span>
                    </a>
                    <a href="#" class="sidebar-item flex items-center space-x-3 px-4 py-3 text-white" data-page="news">
                        <i class="fas fa-newspaper w-5"></i>
                        <span>သတင်းများ</span>
                    </a>
                    <a href="#" class="sidebar-item flex items-center space-x-3 px-4 py-3 text-white" data-page="about">
                        <i class="fas fa-info-circle w-5"></i>
                        <span>အကြောင်းအရာ</span>
                    </a>
                </nav>
            </aside>

            <!-- Main Content -->
            <main class="flex-1 p-6">
                <!-- Dashboard Page -->
                <div id="dashboardPage" class="page-content">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="stat-card p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600">စုစုပေါင်း အသုံးပြုသူများ</p>
                                    <p id="totalUsers" class="text-3xl font-bold text-gray-900">0</p>
                                </div>
                                <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                                    <i class="fas fa-users text-blue-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stat-card p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600">စုစုပေါင်း ကုန်ပစ္စည်းများ</p>
                                    <p id="totalProducts" class="text-3xl font-bold text-gray-900">0</p>
                                </div>
                                <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center">
                                    <i class="fas fa-box text-green-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stat-card p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600">စုစုပေါင်း အမှာစာများ</p>
                                    <p id="totalOrders" class="text-3xl font-bold text-gray-900">0</p>
                                </div>
                                <div class="w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center">
                                    <i class="fas fa-shopping-cart text-yellow-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stat-card p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600">စောင့်ဆိုင်းနေသော KYC</p>
                                    <p id="pendingKyc" class="text-3xl font-bold text-gray-900">0</p>
                                </div>
                                <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center">
                                    <i class="fas fa-id-card text-purple-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="neo-card p-6">
                            <h3 class="text-lg font-semibold mb-4">လတ်တလော အမှာစာများ</h3>
                            <div id="recentOrders" class="space-y-3">
                                <!-- Recent orders will be populated here -->
                            </div>
                        </div>
                        
                        <div class="neo-card p-6">
                            <h3 class="text-lg font-semibold mb-4">ရောင်းအားကိန်းဂဏန်း</h3>
                            <canvas id="salesChart" style="height: 300px;"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Users Management Page -->
                <div id="usersPage" class="page-content hidden">
                    <div class="neo-card p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-2xl font-bold text-gray-800">အသုံးပြုသူများ စီမံခန့်ခွဲမှု</h2>
                            <div class="flex space-x-3">
                                <input type="text" id="userSearchInput" placeholder="ရှာဖွေရန်..." 
                                       class="form-input px-4 py-2">
                                <button id="refreshUsersBtn" class="btn-primary px-4 py-2 rounded-lg">
                                    <i class="fas fa-refresh"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">အမည်</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">အီးမေးလ်</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">KYC အခြေအနေ</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">လုပ်ဆောင်ချက်များ</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTableBody" class="bg-white divide-y divide-gray-200">
                                    <!-- Users will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Products Management Page -->
                <div id="productsPage" class="page-content hidden">
                    <div class="neo-card p-6 mb-6">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-2xl font-bold text-gray-800">ကုန်ပစ္စည်းများ စီမံခန့်ခွဲမှု</h2>
                            <button id="addProductBtn" class="btn-primary px-6 py-2 rounded-lg">
                                <i class="fas fa-plus mr-2"></i>ကုန်ပစ္စည်း အသစ်ထည့်မည်
                            </button>
                        </div>
                        
                        <div class="table-container">
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">အမည်</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ရောင်းသူ</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">စျေးနှုန်း</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">အခြေအနေ</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">လုပ်ဆောင်ချက်များ</th>
                                    </tr>
                                </thead>
                                <tbody id="productsTableBody" class="bg-white divide-y divide-gray-200">
                                    <!-- Products will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Orders Management Page -->
                <div id="ordersPage" class="page-content hidden">
                    <div class="neo-card p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-2xl font-bold text-gray-800">အမှာစာများ စီမံခန့်ခွဲမှု</h2>
                            <div class="flex space-x-3">
                                <select id="orderStatusFilter" class="form-input px-4 py-2">
                                    <option value="">အခြေအနေ အားလုံး</option>
                                    <option value="pending">စောင့်ဆိုင်းနေသော</option>
                                    <option value="approved">အတည်ပြုပြီး</option>
                                    <option value="rejected">ငြင်းပယ်ပြီး</option>
                                </select>
                                <button id="refreshOrdersBtn" class="btn-primary px-4 py-2 rounded-lg">
                                    <i class="fas fa-refresh"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ဝယ်သူ</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ကုန်ပစ္စည်း</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">တန်ဖိုး</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">အခြေအနေ</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ရက်စွဲ</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">လုပ်ဆောင်ချက်များ</th>
                                    </tr>
                                </thead>
                                <tbody id="ordersTableBody" class="bg-white divide-y divide-gray-200">
                                    <!-- Orders will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Payment Methods Page -->
                <div id="paymentsPage" class="page-content hidden">
                    <div class="neo-card p-6 mb-6">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-2xl font-bold text-gray-800">ငွေပေးချေမှုနည်းလမ်းများ</h2>
                            <button id="addPaymentBtn" class="btn-primary px-6 py-2 rounded-lg">
                                <i class="fas fa-plus mr-2"></i>နည်းလမ်း အသစ်ထည့်မည်
                            </button>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="paymentMethodsGrid">
                            <!-- Payment methods will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- KYC Verification Page -->
                <div id="kycPage" class="page-content hidden">
                    <div class="neo-card p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-2xl font-bold text-gray-800">KYC အတည်ပြုမှုများ</h2>
                            <div class="flex space-x-3">
                                <select id="kycStatusFilter" class="form-input px-4 py-2">
                                    <option value="">အခြေအနေ အားလုံး</option>
                                    <option value="pending">စောင့်ဆိုင်းနေသော</option>
                                    <option value="approved">အတည်ပြုပြီး</option>
                                    <option value="rejected">ငြင်းပယ်ပြီး</option>
                                </select>
                                <button id="refreshKycBtn" class="btn-primary px-4 py-2 rounded-lg">
                                    <i class="fas fa-refresh"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">အမည်</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">အသုံးပြုသူ</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">စာရွက်စာတမ်း</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">အခြေအနေ</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">လုပ်ဆောင်ချက်များ</th>
                                    </tr>
                                </thead>
                                <tbody id="kycTableBody" class="bg-white divide-y divide-gray-200">
                                    <!-- KYC records will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- News Management Page -->
                <div id="newsPage" class="page-content hidden">
                    <div class="neo-card p-6 mb-6">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-2xl font-bold text-gray-800">သတင်းများ စီမံခန့်ခွဲမှု</h2>
                            <button id="addNewsBtn" class="btn-primary px-6 py-2 rounded-lg">
                                <i class="fas fa-plus mr-2"></i>သတင်း အသစ်ထည့်မည်
                            </button>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="newsGrid">
                            <!-- News items will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- About Management Page -->
                <div id="aboutPage" class="page-content hidden">
                    <div class="neo-card p-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6">အကြောင်းအရာ စီမံခန့်ခွဲမှု</h2>
                        
                        <form id="aboutForm" class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">ခေါင်းစဉ်</label>
                                    <input type="text" id="aboutTitle" class="form-input w-full px-4 py-3" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">ဖုန်းနံပါတ်</label>
                                    <input type="text" id="aboutPhone" class="form-input w-full px-4 py-3">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">အီးမေးလ်</label>
                                <input type="email" id="aboutEmail" class="form-input w-full px-4 py-3">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">လိပ်စာ</label>
                                <textarea id="aboutAddress" class="form-input w-full px-4 py-3" rows="3"></textarea>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">အကြောင်းအရာ</label>
                                <textarea id="aboutContent" class="form-input w-full px-4 py-3" rows="5" required></textarea>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Telegram Link</label>
                                    <input type="url" id="aboutTelegram" class="form-input w-full px-4 py-3">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">YouTube Link</label>
                                    <input type="url" id="aboutYoutube" class="form-input w-full px-4 py-3">
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Viber Link</label>
                                    <input type="url" id="aboutViber" class="form-input w-full px-4 py-3">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">WeChat Link</label>
                                    <input type="url" id="aboutWechat" class="form-input w-full px-4 py-3">
                                </div>
                            </div>
                            
                            <button type="submit" class="btn-primary px-8 py-3 rounded-lg">
                                <i class="fas fa-save mr-2"></i>သိမ်းဆည်းမည်
                            </button>
                        </form>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Modals -->
    <!-- Add Product Modal -->
    <div id="addProductModal" class="modal fixed inset-0 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="modal-content max-w-4xl w-full max-h-screen overflow-y-auto p-8">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-bold text-gray-800">ကုန်ပစ္စည်း အသစ်ထည့်မည်</h3>
                    <button class="modal-close text-gray-400 hover:text-gray-600 text-2xl">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <form id="addProductForm" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ကုန်ပစ္စည်း အမည်</label>
                            <input type="text" name="name" required class="form-input w-full px-4 py-3">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ကုန်ပစ္စည်း အမျိုးအစား</label>
                            <select name="product_type" class="form-input w-full px-4 py-3" required>
                                <option value="">ရွေးချယ်ပါ</option>
                                <option value="apk">APK ဖိုင်</option>
                                <option value="game_account">ဂိမ်းအကောင့်</option>
                            </select>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">စျေးနှုန်း (MMK)</label>
                        <input type="number" name="price" required class="form-input w-full px-4 py-3">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ဖော်ပြချက်</label>
                        <textarea name="description" rows="4" class="form-input w-full px-4 py-3"></textarea>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ကုန်ပစ္စည်း ပုံ</label>
                            <div class="upload-area p-6 text-center cursor-pointer">
                                <input type="file" name="icon_image" accept="image/*" class="hidden">
                                <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
                                <p class="text-gray-600">ပုံတင်ရန် ကလစ်နှိပ်ပါ</p>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">APK ဖိုင် (APK အမျိုးအစားမှာသာ)</label>
                            <div class="upload-area p-6 text-center cursor-pointer">
                                <input type="file" name="apk_file" accept=".apk" class="hidden">
                                <i class="fas fa-mobile-alt text-3xl text-gray-400 mb-2"></i>
                                <p class="text-gray-600">APK ဖိုင်တင်ရန် ကလစ်နှိပ်ပါ</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-end space-x-4">
                        <button type="button" class="modal-close px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors">
                            ပိတ်မည်
                        </button>
                        <button type="submit" class="btn-primary px-8 py-3 rounded-lg">
                            <span>သိမ်းဆည်းမည်</span>
                            <div class="loading-spinner hidden ml-2"></div>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Add News Modal -->
    <div id="addNewsModal" class="modal fixed inset-0 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="modal-content max-w-4xl w-full max-h-screen overflow-y-auto p-8">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-bold text-gray-800">သတင်း အသစ်ထည့်မည်</h3>
                    <button class="modal-close text-gray-400 hover:text-gray-600 text-2xl">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <form id="addNewsForm" class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">သတင်း ခေါင်းစဉ်</label>
                        <input type="text" name="title" required class="form-input w-full px-4 py-3">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">သတင်း အကြောင်းအရာ</label>
                        <textarea name="content" rows="6" required class="form-input w-full px-4 py-3"></textarea>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ဗီဒီယို (50MB အထိ)</label>
                            <div class="upload-area p-6 text-center cursor-pointer">
                                <input type="file" name="video" accept="video/mp4" class="hidden">
                                <i class="fas fa-video text-3xl text-gray-400 mb-2"></i>
                                <p class="text-gray-600">ဗီဒီယိုတင်ရန် ကလစ်နှိပ်ပါ</p>
                                <p class="text-xs text-gray-500">အများဆုံး 50MB</p>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ပုံများ</label>
                            <div class="upload-area p-6 text-center cursor-pointer">
                                <input type="file" name="images" accept="image/*" multiple class="hidden">
                                <i class="fas fa-images text-3xl text-gray-400 mb-2"></i>
                                <p class="text-gray-600">ပုံများတင်ရန် ကလစ်နှိပ်ပါ</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-end space-x-4">
                        <button type="button" class="modal-close px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors">
                            ပိတ်မည်
                        </button>
                        <button type="submit" class="btn-primary px-8 py-3 rounded-lg">
                            <span>သိမ်းဆည်းမည်</span>
                            <div class="loading-spinner hidden ml-2"></div>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Add Payment Method Modal -->
    <div id="addPaymentModal" class="modal fixed inset-0 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="modal-content max-w-2xl w-full p-8">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-bold text-gray-800">ငွေပေးချေမှုနည်းလမ်း အသစ်ထည့်မည်</h3>
                    <button class="modal-close text-gray-400 hover:text-gray-600 text-2xl">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <form id="addPaymentForm" class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">နည်းလမ်း အမည်</label>
                        <input type="text" name="name" required class="form-input w-full px-4 py-3">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">အကောင့် အချက်အလက်</label>
                        <input type="text" name="details" required class="form-input w-full px-4 py-3">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ဖော်ပြချက်</label>
                        <textarea name="description" rows="3" class="form-input w-full px-4 py-3"></textarea>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">QR Code ပုံ</label>
                        <div class="upload-area p-6 text-center cursor-pointer">
                            <input type="file" name="qr_code" accept="image/*" required class="hidden">
                            <i class="fas fa-qrcode text-3xl text-gray-400 mb-2"></i>
                            <p class="text-gray-600">QR Code ပုံတင်ရန် ကလစ်နှိပ်ပါ</p>
                        </div>
                    </div>
                    
                    <div class="flex justify-end space-x-4">
                        <button type="button" class="modal-close px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors">
                            ပိတ်မည်
                        </button>
                        <button type="submit" class="btn-primary px-8 py-3 rounded-lg">
                            <span>သိမ်းဆည်းမည်</span>
                            <div class="loading-spinner hidden ml-2"></div>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- View KYC Modal -->
    <div id="viewKycModal" class="modal fixed inset-0 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="modal-content max-w-6xl w-full max-h-screen overflow-y-auto p-8">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-bold text-gray-800">KYC အတည်ပြုမှု စစ်ဆေးရန်</h3>
                    <button class="modal-close text-gray-400 hover:text-gray-600 text-2xl">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div id="kycDetailsContent">
                    <!-- KYC details will be populated here -->
                </div>
                
                <div class="flex justify-end space-x-4 pt-6 border-t">
                    <button id="rejectKycBtn" class="px-6 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">
                        <i class="fas fa-times mr-2"></i>ငြင်းပယ်မည်
                    </button>
                    <button id="approveKycBtn" class="px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors">
                        <i class="fas fa-check mr-2"></i>အတည်ပြုမည်
                    </button>
                    <button class="modal-close px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors">
                        ပိတ်မည်
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer" class="fixed top-4 right-4 z-50 space-y-4">
        <!-- Notifications will appear here -->
    </div>

    <script>
        // Initialize Supabase
        const SUPABASE_URL = 'https://rliwdosxsbauwxkayjoa.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJsaXdkb3N4c2JhdXd4a2F5am9hIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQxMDA2NjIsImV4cCI6MjA2OTY3NjY2Mn0.uDvU9eX3Cy--D9l6daGaO2QMpn1YnxMJYVlbaeIgHu4';
        
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        
        // Admin credentials (hardcoded as requested)
        const ADMIN_CREDENTIALS = {
            email: 'opper@opper.com',
            password: '155872'
        };
        
        // Global variables
        let currentUser = null;
        let salesChart = null;
        
        // DOM Elements
        const loginPage = document.getElementById('loginPage');
        const adminDashboard = document.getElementById('adminDashboard');
        const adminLoginForm = document.getElementById('adminLoginForm');
        const logoutBtn = document.getElementById('logoutBtn');
        
        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            checkAdminAuth();
            initializeEventListeners();
        });
        
        // Check if admin is already logged in
        function checkAdminAuth() {
            const adminToken = localStorage.getItem('mmr_admin_session');
            if (adminToken) {
                try {
                    const session = JSON.parse(adminToken);
                    if (session.email === ADMIN_CREDENTIALS.email) {
                        currentUser = session;
                        showDashboard();
                        return;
                    }
                } catch (error) {
                    console.error('Session check failed:', error);
                }
            }
            showLogin();
        }
        
        // Show login page
        function showLogin() {
            loginPage.classList.remove('hidden');
            adminDashboard.classList.add('hidden');
        }
        
        // Show dashboard
        function showDashboard() {
            loginPage.classList.add('hidden');
            adminDashboard.classList.remove('hidden');
            loadDashboardData();
            initializeChart();
        }
        
        // Initialize event listeners
        function initializeEventListeners() {
            // Login form
            adminLoginForm.addEventListener('submit', handleAdminLogin);
            
            // Logout button
            logoutBtn.addEventListener('click', handleLogout);
            
            // Sidebar navigation
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.addEventListener('click', handleSidebarClick);
            });
            
            // Modal close buttons
            document.querySelectorAll('.modal-close').forEach(btn => {
                btn.addEventListener('click', closeAllModals);
            });
            
            // Add buttons
            document.getElementById('addProductBtn')?.addEventListener('click', () => openModal('addProductModal'));
            document.getElementById('addPaymentBtn')?.addEventListener('click', () => openModal('addPaymentModal'));
            document.getElementById('addNewsBtn')?.addEventListener('click', () => openModal('addNewsModal'));
            
            // Forms
            document.getElementById('addProductForm')?.addEventListener('submit', handleAddProduct);
            document.getElementById('addPaymentForm')?.addEventListener('submit', handleAddPayment);
            document.getElementById('addNewsForm')?.addEventListener('submit', handleAddNews);
            document.getElementById('aboutForm')?.addEventListener('submit', handleUpdateAbout);
            
            // Refresh buttons
            document.getElementById('refreshUsersBtn')?.addEventListener('click', loadUsers);
            document.getElementById('refreshOrdersBtn')?.addEventListener('click', loadOrders);
            document.getElementById('refreshKycBtn')?.addEventListener('click', loadKycRequests);
            
            // Upload areas
            document.querySelectorAll('.upload-area').forEach(area => {
                area.addEventListener('click', () => {
                    const fileInput = area.querySelector('input[type="file"]');
                    fileInput?.click();
                });
            });
        }
        
        // Handle admin login
        async function handleAdminLogin(e) {
            e.preventDefault();
            
            const email = document.getElementById('adminEmail').value;
            const password = document.getElementById('adminPassword').value;
            
            setLoading('loginBtnText', 'loginLoading', true, 'ဝင်ရောက်နေသည်...');
            
            try {
                if (email === ADMIN_CREDENTIALS.email && password === ADMIN_CREDENTIALS.password) {
                    const session = {
                        email: email,
                        loginTime: new Date().toISOString()
                    };
                    
                    localStorage.setItem('mmr_admin_session', JSON.stringify(session));
                    currentUser = session;
                    
                    showNotification('အောင်မြင်စွာ ဝင်ရောက်ပါပြီ', 'success');
                    showDashboard();
                } else {
                    throw new Error('အီးမေးလ် သို့မဟုတ် စကားဝှက် မှားနေပါသည်');
                }
            } catch (error) {
                console.error('Login failed:', error);
                showNotification(error.message, 'error');
            } finally {
                setLoading('loginBtnText', 'loginLoading', false, 'ဝင်ရောက်မည်');
            }
        }
        
        // Handle logout
        function handleLogout() {
            localStorage.removeItem('mmr_admin_session');
            currentUser = null;
            showLogin();
            showNotification('အောင်မြင်စွာ ထွက်ခွါပါပြီ', 'warning');
        }
        
        // Handle sidebar navigation
        function handleSidebarClick(e) {
            e.preventDefault();
            
            const page = this.getAttribute('data-page');
            
            // Update active sidebar item
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('active');
            });
            this.classList.add('active');
            
            // Show corresponding page
            document.querySelectorAll('.page-content').forEach(content => {
                content.classList.add('hidden');
            });
            document.getElementById(page + 'Page')?.classList.remove('hidden');
            
            // Load page data
            switch(page) {
                case 'dashboard':
                    loadDashboardData();
                    break;
                case 'users':
                    loadUsers();
                    break;
                case 'products':
                    loadProducts();
                    break;
                case 'orders':
                    loadOrders();
                    break;
                case 'payments':
                    loadPaymentMethods();
                    break;
                case 'kyc':
                    loadKycRequests();
                    break;
                case 'news':
                    loadNews();
                    break;
                case 'about':
                    loadAboutData();
                    break;
            }
        }
        
        // Data loading functions
        async function loadDashboardData() {
            try {
                // Load statistics
                const [usersResult, productsResult, ordersResult, kycResult] = await Promise.all([
                    supabase.from('users').select('id', { count: 'exact', head: true }),
                    supabase.from('products').select('id', { count: 'exact', head: true }),
                    supabase.from('orders').select('id', { count: 'exact', head: true }),
                    supabase.from('kyc_verifications').select('id', { count: 'exact', head: true }).eq('status', 'pending')
                ]);
                
                document.getElementById('totalUsers').textContent = usersResult.count || 0;
                document.getElementById('totalProducts').textContent = productsResult.count || 0;
                document.getElementById('totalOrders').textContent = ordersResult.count || 0;
                document.getElementById('pendingKyc').textContent = kycResult.count || 0;
                
                // Load recent orders
                loadRecentOrders();
                
            } catch (error) {
                console.error('Failed to load dashboard data:', error);
                showNotification('ဒေတာများ ရယူ၍မရပါ', 'error');
            }
        }
        
        async function loadUsers() {
            try {
                const { data: users, error } = await supabase
                    .from('users')
                    .select('*')
                    .order('created_at', { ascending: false });
                
                if (error) throw error;
                
                const tbody = document.getElementById('usersTableBody');
                if (!tbody) return;
                
                tbody.innerHTML = users?.map(user => `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <img class="h-10 w-10 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold" 
                                     src="${user.profile_image || ''}" 
                                     alt="${user.name}"
                                     onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <div class="h-10 w-10 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold hidden">
                                    ${user.name.charAt(0).toUpperCase()}
                                </div>
                                <div class="ml-4">
                                    <div class="text-sm font-medium text-gray-900">${user.name}</div>
                                    <div class="text-sm text-gray-500">${user.username}</div>
                                </div>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${user.email}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="status-${user.kyc_status}">${getStatusText(user.kyc_status)}</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                            <button onclick="viewUser('${user.id}')" class="text-blue-600 hover:text-blue-900">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button onclick="deleteUser('${user.id}')" class="text-red-600 hover:text-red-900">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `).join('') || '<tr><td colspan="4" class="text-center py-8 text-gray-500">အသုံးပြုသူများ မရှိသေးပါ</td></tr>';
                
            } catch (error) {
                console.error('Failed to load users:', error);
                showNotification('အသုံးပြုသူများ ရယူ၍မရပါ', 'error');
            }
        }
        
        async function loadProducts() {
            try {
                const { data: products, error } = await supabase
                    .from('products')
                    .select(`
                        *,
                        users(name, username)
                    `)
                    .order('created_at', { ascending: false });
                
                if (error) throw error;
                
                const tbody = document.getElementById('productsTableBody');
                if (!tbody) return;
                
                tbody.innerHTML = products?.map(product => `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <img class="h-10 w-10 rounded-lg object-cover" 
                                     src="${product.icon_image || ''}" 
                                     alt="${product.name}"
                                     onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <div class="h-10 w-10 rounded-lg bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white hidden">
                                    <i class="fas fa-${product.product_type === 'apk' ? 'mobile-alt' : 'gamepad'}"></i>
                                </div>
                                <div class="ml-4">
                                    <div class="text-sm font-medium text-gray-900">${product.name}</div>
                                    <div class="text-sm text-gray-500">${product.product_type}</div>
                                </div>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${product.users?.name || 'Admin'}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${formatPrice(product.price)} Ks
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="status-${product.status || 'active'}">${getStatusText(product.status || 'active')}</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                            <button onclick="approveProduct('${product.id}')" class="text-green-600 hover:text-green-900">
                                <i class="fas fa-check"></i>
                            </button>
                            <button onclick="rejectProduct('${product.id}')" class="text-red-600 hover:text-red-900">
                                <i class="fas fa-times"></i>
                            </button>
                            <button onclick="deleteProduct('${product.id}')" class="text-red-600 hover:text-red-900">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `).join('') || '<tr><td colspan="5" class="text-center py-8 text-gray-500">ကုန်ပစ္စည်းများ မရှိသေးပါ</td></tr>';
                
            } catch (error) {
                console.error('Failed to load products:', error);
                showNotification('ကုန်ပစ္စည်းများ ရယူ၍မရပါ', 'error');
            }
        }
        
        async function loadOrders() {
            try {
                const { data: orders, error } = await supabase
                    .from('orders')
                    .select(`
                        *,
                        buyer:users!buyer_id(name, email),
                        product:products(name, price)
                    `)
                    .order('ordered_at', { ascending: false });
                
                if (error) throw error;
                
                const tbody = document.getElementById('ordersTableBody');
                if (!tbody) return;
                
                tbody.innerHTML = orders?.map(order => `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${order.buyer?.name || 'N/A'}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${order.product?.name || 'N/A'}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${formatPrice(order.amount)} Ks
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="status-${order.status}">${getStatusText(order.status)}</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${formatDate(order.ordered_at)}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                            <button onclick="approveOrder('${order.id}')" class="text-green-600 hover:text-green-900">
                                <i class="fas fa-check"></i>
                            </button>
                            <button onclick="rejectOrder('${order.id}')" class="text-red-600 hover:text-red-900">
                                <i class="fas fa-times"></i>
                            </button>
                        </td>
                    </tr>
                `).join('') || '<tr><td colspan="6" class="text-center py-8 text-gray-500">အမှာစာများ မရှိသေးပါ</td></tr>';
                
            } catch (error) {
                console.error('Failed to load orders:', error);
                showNotification('အမှာစာများ ရယူ၍မရပါ', 'error');
            }
        }
        
        async function loadKycRequests() {
            try {
                const { data: kycRequests, error } = await supabase
                    .from('kyc_verifications')
                    .select(`
                        *,
                        users(name, email)
                    `)
                    .order('submitted_at', { ascending: false });
                
                if (error) throw error;
                
                const tbody = document.getElementById('kycTableBody');
                if (!tbody) return;
                
                tbody.innerHTML = kycRequests?.map(kyc => `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${kyc.full_name}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${kyc.users?.name || 'N/A'}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            ${getDocumentTypeText(kyc.document_type)}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="status-${kyc.status}">${getStatusText(kyc.status)}</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                            <button onclick="viewKyc('${kyc.id}')" class="text-blue-600 hover:text-blue-900">
                                <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    </tr>
                `).join('') || '<tr><td colspan="5" class="text-center py-8 text-gray-500">KYC တောင်းဆိုများ မရှိသေးပါ</td></tr>';
                
            } catch (error) {
                console.error('Failed to load KYC requests:', error);
                showNotification('KYC တောင်းဆိုများ ရယူ၍မရပါ', 'error');
            }
        }
        
        async function loadPaymentMethods() {
            try {
                const { data: paymentMethods, error } = await supabase
                    .from('payment_methods')
                    .select('*')
                    .order('created_at', { ascending: false });
                
                if (error) throw error;
                
                const grid = document.getElementById('paymentMethodsGrid');
                if (!grid) return;
                
                grid.innerHTML = paymentMethods?.map(method => `
                    <div class="neo-card p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold">${method.name}</h3>
                            <button onclick="deletePaymentMethod('${method.id}')" class="text-red-500 hover:text-red-700">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                        <p class="text-gray-600 mb-2">${method.details}</p>
                        ${method.description ? `<p class="text-sm text-gray-500 mb-4">${method.description}</p>` : ''}
                        ${method.qr_code ? `
                            <div class="text-center">
                                <img src="${method.qr_code}" alt="QR Code" class="w-32 h-32 mx-auto rounded-lg">
                            </div>
                        ` : ''}
                    </div>
                `).join('') || '<div class="col-span-full text-center py-8 text-gray-500">ငွေပေးချေမှုနည်းလမ်းများ မရှိသေးပါ</div>';
                
            } catch (error) {
                console.error('Failed to load payment methods:', error);
                showNotification('ငွေပေးချေမှုနည်းလမ်းများ ရယူ၍မရပါ', 'error');
            }
        }
        
        async function loadNews() {
            try {
                const { data: news, error } = await supabase
                    .from('news')
                    .select('*')
                    .order('created_at', { ascending: false });
                
                if (error) throw error;
                
                const grid = document.getElementById('newsGrid');
                if (!grid) return;
                
                grid.innerHTML = news?.map(item => `
                    <div class="neo-card p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold truncate">${item.title}</h3>
                            <button onclick="deleteNews('${item.id}')" class="text-red-500 hover:text-red-700">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                        <p class="text-gray-600 text-sm line-clamp-3 mb-4">${item.content}</p>
                        <div class="flex items-center justify-between text-sm text-gray-500">
                            <span>${formatDate(item.created_at)}</span>
                            <span class="status-${item.is_published ? 'approved' : 'pending'}">
                                ${item.is_published ? 'ထုတ်ပြန်ပြီး' : 'မထုတ်ပြန်သေး'}
                            </span>
                        </div>
                    </div>
                `).join('') || '<div class="col-span-full text-center py-8 text-gray-500">သတင်းများ မရှိသေးပါ</div>';
                
            } catch (error) {
                console.error('Failed to load news:', error);
                showNotification('သတင်းများ ရယူ၍မရပါ', 'error');
            }
        }
        
        async function loadAboutData() {
            try {
                const { data: about, error } = await supabase
                    .from('about')
                    .select('*')
                    .single();
                
                if (error && error.code !== 'PGRST116') throw error;
                
                if (about) {
                    document.getElementById('aboutTitle').value = about.title || '';
                    document.getElementById('aboutContent').value = about.content || '';
                    document.getElementById('aboutAddress').value = about.address || '';
                    document.getElementById('aboutPhone').value = about.phone || '';
                    document.getElementById('aboutEmail').value = about.email || '';
                    
                    if (about.social_links) {
                        document.getElementById('aboutTelegram').value = about.social_links.telegram || '';
                        document.getElementById('aboutYoutube').value = about.social_links.youtube || '';
                        document.getElementById('aboutViber').value = about.social_links.viber || '';
                        document.getElementById('aboutWechat').value = about.social_links.wechat || '';
                    }
                }
            } catch (error) {
                console.error('Failed to load about data:', error);
                showNotification('အကြောင်းအရာ ရယူ၍မရပါ', 'error');
            }
        }
        
        async function loadRecentOrders() {
            try {
                const { data: orders, error } = await supabase
                    .from('orders')
                    .select(`
                        *,
                        buyer:users!buyer_id(name),
                        product:products(name, price)
                    `)
                    .order('ordered_at', { ascending: false })
                    .limit(5);
                
                if (error) throw error;
                
                const container = document.getElementById('recentOrders');
                if (!container) return;
                
                container.innerHTML = orders?.map(order => `
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div>
                            <p class="font-medium text-gray-900">${order.buyer?.name || 'N/A'}</p>
                            <p class="text-sm text-gray-600">${order.product?.name || 'N/A'}</p>
                        </div>
                        <div class="text-right">
                            <p class="font-medium text-gray-900">${formatPrice(order.amount)} Ks</p>
                            <p class="text-sm status-${order.status}">${getStatusText(order.status)}</p>
                        </div>
                    </div>
                `).join('') || '<p class="text-gray-500 text-center">လတ်တလော အမှာစာများ မရှိပါ</p>';
                
            } catch (error) {
                console.error('Failed to load recent orders:', error);
            }
        }
        
        // Form handlers
        async function handleAddProduct(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const productData = {
                name: formData.get('name'),
                product_type: formData.get('product_type'),
                price: parseFloat(formData.get('price')),
                description: formData.get('description'),
                is_admin_product: true,
                status: 'approved'
            };
            
            try {
                const { data, error } = await supabase
                    .from('products')
                    .insert([productData])
                    .select()
                    .single();
                
                if (error) throw error;
                
                showNotification('ကုန်ပစ္စည်း အောင်မြင်စွာ ထည့်ပြီးပါပြီ', 'success');
                closeAllModals();
                loadProducts();
                e.target.reset();
                
            } catch (error) {
                console.error('Failed to add product:', error);
                showNotification('ကုန်ပစ္စည်း ထည့်၍မရပါ', 'error');
            }
        }
        
        async function handleAddPayment(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const paymentData = {
                name: formData.get('name'),
                details: formData.get('details'),
                description: formData.get('description'),
                is_admin_method: true
            };
            
            try {
                const { data, error } = await supabase
                    .from('payment_methods')
                    .insert([paymentData])
                    .select()
                    .single();
                
                if (error) throw error;
                
                showNotification('ငွေပေးချေမှုနည်းလမ်း အောင်မြင်စွာ ထည့်ပြီးပါပြီ', 'success');
                closeAllModals();
                loadPaymentMethods();
                e.target.reset();
                
            } catch (error) {
                console.error('Failed to add payment method:', error);
                showNotification('ငွေပေးချေမှုနည်းလမ်း ထည့်၍မရပါ', 'error');
            }
        }
        
        async function handleAddNews(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const newsData = {
                title: formData.get('title'),
                content: formData.get('content'),
                is_published: true
            };
            
            try {
                const { data, error } = await supabase
                    .from('news')
                    .insert([newsData])
                    .select()
                    .single();
                
                if (error) throw error;
                
                showNotification('သတင်း အောင်မြင်စွာ ထည့်ပြီးပါပြီ', 'success');
                closeAllModals();
                loadNews();
                e.target.reset();
                
            } catch (error) {
                console.error('Failed to add news:', error);
                showNotification('သတင်း ထည့်၍မရပါ', 'error');
            }
        }
        
        async function handleUpdateAbout(e) {
            e.preventDefault();
            
            const aboutData = {
                title: document.getElementById('aboutTitle').value,
                content: document.getElementById('aboutContent').value,
                address: document.getElementById('aboutAddress').value,
                phone: document.getElementById('aboutPhone').value,
                email: document.getElementById('aboutEmail').value,
                social_links: {
                    telegram: document.getElementById('aboutTelegram').value,
                    youtube: document.getElementById('aboutYoutube').value,
                    viber: document.getElementById('aboutViber').value,
                    wechat: document.getElementById('aboutWechat').value
                }
            };
            
            try {
                const { data, error } = await supabase
                    .from('about')
                    .upsert([aboutData])
                    .select()
                    .single();
                
                if (error) throw error;
                
                showNotification('အကြောင်းအရာ အောင်မြင်စွာ သိမ်းဆည်းပြီးပါပြီ', 'success');
                
            } catch (error) {
                console.error('Failed to update about:', error);
                showNotification('အကြောင်းအရာ သိမ်းဆည်း၍မရပါ', 'error');
            }
        }
        
        // Action handlers
        async function approveProduct(productId) {
            try {
                const { error } = await supabase
                    .from('products')
                    .update({ status: 'approved' })
                    .eq('id', productId);
                
                if (error) throw error;
                
                showNotification('ကုန်ပစ္စည်း အတည်ပြုပြီးပါပြီ', 'success');
                loadProducts();
                
            } catch (error) {
                console.error('Failed to approve product:', error);
                showNotification('ကုန်ပစ္စည်း အတည်ပြု၍မရပါ', 'error');
            }
        }
        
        async function rejectProduct(productId) {
            try {
                const { error } = await supabase
                    .from('products')
                    .update({ status: 'rejected' })
                    .eq('id', productId);
                
                if (error) throw error;
                
                showNotification('ကုန်ပစ္စည်း ငြင်းပယ်ပြီးပါပြီ', 'warning');
                loadProducts();
                
            } catch (error) {
                console.error('Failed to reject product:', error);
                showNotification('ကုန်ပစ္စည်း ငြင်းပယ်၍မရပါ', 'error');
            }
        }
        
        async function approveOrder(orderId) {
            try {
                const { error } = await supabase
                    .from('orders')
                    .update({ 
                        status: 'approved',
                        download_approved: true,
                        processed_at: new Date().toISOString()
                    })
                    .eq('id', orderId);
                
                if (error) throw error;
                
                showNotification('အမှာစာ အတည်ပြုပြီးပါပြီ', 'success');
                loadOrders();
                loadDashboardData();
                
            } catch (error) {
                console.error('Failed to approve order:', error);
                showNotification('အမှာစာ အတည်ပြု၍မရပါ', 'error');
            }
        }
        
        async function rejectOrder(orderId) {
            try {
                const { error } = await supabase
                    .from('orders')
                    .update({ 
                        status: 'rejected',
                        processed_at: new Date().toISOString()
                    })
                    .eq('id', orderId);
                
                if (error) throw error;
                
                showNotification('အမှာစာ ငြင်းပယ်ပြီးပါပြီ', 'warning');
                loadOrders();
                loadDashboardData();
                
            } catch (error) {
                console.error('Failed to reject order:', error);
                showNotification('အမှာစာ ငြင်းပယ်၍မရပါ', 'error');
            }
        }
        
        async function viewKyc(kycId) {
            try {
                const { data: kyc, error } = await supabase
                    .from('kyc_verifications')
                    .select(`
                        *,
                        users(name, email)
                    `)
                    .eq('id', kycId)
                    .single();
                
                if (error) throw error;
                
                const kycDetails = document.getElementById('kycDetailsContent');
                kycDetails.innerHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-semibold mb-4">ကိုယ်ရေးကိုယ်တာအချက်အလက်</h4>
                            <div class="space-y-3">
                                <p><strong>အမည်:</strong> ${kyc.full_name}</p>
                                <p><strong>မွေးသက္ကရာဇ်:</strong> ${kyc.date_of_birth}</p>
                                <p><strong>စာရွက်စာတမ်းအမျိုးအစား:</strong> ${getDocumentTypeText(kyc.document_type)}</p>
                                <p><strong>လိပ်စာ:</strong> ${kyc.address}</p>
                                <p><strong>တင်သွင်းသည့်ရက်:</strong> ${formatDate(kyc.submitted_at)}</p>
                            </div>
                        </div>
                        <div>
                            <h4 class="font-semibold mb-4">စာရွက်စာတမ်းများ</h4>
                            <div class="space-y-4">
                                <div>
                                    <p class="text-sm font-medium mb-2">စာရွက်စာတမ်း (ရှေ့ပိုင်း):</p>
                                    <img src="${kyc.document_front}" alt="Document Front" class="w-full max-w-xs rounded-lg border">
                                </div>
                                ${kyc.document_back ? `
                                    <div>
                                        <p class="text-sm font-medium mb-2">စာရွက်စာတမ်း (နောက်ပိုင်း):</p>
                                        <img src="${kyc.document_back}" alt="Document Back" class="w-full max-w-xs rounded-lg border">
                                    </div>
                                ` : ''}
                                <div>
                                    <p class="text-sm font-medium mb-2">စာရွက်စာတမ်းနဲ့အတူ ဓာတ်ပုံ:</p>
                                    <img src="${kyc.selfie_with_document}" alt="Selfie" class="w-full max-w-xs rounded-lg border">
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Store current KYC ID for approval/rejection
                document.getElementById('approveKycBtn').onclick = () => approveKyc(kycId);
                document.getElementById('rejectKycBtn').onclick = () => rejectKyc(kycId);
                
                openModal('viewKycModal');
                
            } catch (error) {
                console.error('Failed to load KYC details:', error);
                showNotification('KYC အချက်အလက်များ ရယူ၍မရပါ', 'error');
            }
        }
        
        async function approveKyc(kycId) {
            try {
                const { data: kyc, error: kycError } = await supabase
                    .from('kyc_verifications')
                    .update({ 
                        status: 'approved',
                        reviewed_at: new Date().toISOString()
                    })
                    .eq('id', kycId)
                    .select('user_id')
                    .single();
                
                if (kycError) throw kycError;
                
                // Update user to be seller
                const { error: userError } = await supabase
                    .from('users')
                    .update({ 
                        kyc_status: 'approved',
                        is_seller: true
                    })
                    .eq('id', kyc.user_id);
                
                if (userError) throw userError;
                
                showNotification('KYC အတည်ပြုပြီးပါပြီ - အသုံးပြုသူသည် ရောင်းသူဖြစ်လာပါပြီ', 'success');
                closeAllModals();
                loadKycRequests();
                loadDashboardData();
                
            } catch (error) {
                console.error('Failed to approve KYC:', error);
                showNotification('KYC အတည်ပြု၍မရပါ', 'error');
            }
        }
        
        async function rejectKyc(kycId) {
            try {
                const { error } = await supabase
                    .from('kyc_verifications')
                    .update({ 
                        status: 'rejected',
                        reviewed_at: new Date().toISOString()
                    })
                    .eq('id', kycId);
                
                if (error) throw error;
                
                showNotification('KYC ငြင်းပယ်ပြီးပါပြီ', 'warning');
                closeAllModals();
                loadKycRequests();
                loadDashboardData();
                
            } catch (error) {
                console.error('Failed to reject KYC:', error);
                showNotification('KYC ငြင်းပယ်၍မရပါ', 'error');
            }
        }
        
        // Utility functions
        function openModal(modalId) {
            document.getElementById(modalId)?.classList.remove('hidden');
        }
        
        function closeAllModals() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.classList.add('hidden');
            });
        }
        
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}-notification`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'exclamation-triangle'} mr-3"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.getElementById('notificationContainer').appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }
        
        function setLoading(textId, loaderId, isLoading, text = '') {
            const textElement = document.getElementById(textId);
            const loaderElement = document.getElementById(loaderId);
            
            if (textElement) {
                textElement.textContent = isLoading ? text : 'ဝင်ရောက်မည်';
            }
            
            if (loaderElement) {
                loaderElement.classList.toggle('hidden', !isLoading);
            }
        }
        
        function formatPrice(price) {
            return new Intl.NumberFormat('my-MM').format(price);
        }
        
        function formatDate(date) {
            return new Date(date).toLocaleDateString('my-MM');
        }
        
        function getStatusText(status) {
            const statusMap = {
                'pending': 'စောင့်ဆိုင်းနေသော',
                'approved': 'အတည်ပြုပြီး',
                'rejected': 'ငြင်းပယ်ပြီး',
                'active': 'အသုံးပြုနေသော'
            };
            return statusMap[status] || status;
        }
        
        function getDocumentTypeText(type) {
            const typeMap = {
                'nrc': 'နိုင်ငံသားစီစစ်ရေးကတ်ပြား',
                'passport': 'နိုင်ငံကူးလက်မှတ်',
                'driver': 'ယာဉ်မောင်းလိုင်စင်'
            };
            return typeMap[type] || type;
        }
        
        // Initialize Chart
        function initializeChart() {
            const ctx = document.getElementById('salesChart')?.getContext('2d');
            if (!ctx) return;
            
            salesChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['ဇန်', 'ဖေ', 'မတ်', 'ဧပြီ', 'မေ', 'ဇွန်'],
                    datasets: [{
                        label: 'ရောင်းအား',
                        data: [12, 19, 3, 5, 2, 3],
                        borderColor: 'rgb(59, 130, 246)',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
